<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Building for Android</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/custom.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">Welcome</li><li class="spacer"></li><li class="chapter-item expanded "><a href="../index.html">üëã About: IOTA for Flutter</a></li><li class="chapter-item expanded "><a href="../welcome/what-youll-get.html">üíª What you'll get</a></li><li class="chapter-item expanded "><a href="../welcome/when-you-are-js-developer/index.html">‚òï When you are JS developer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../welcome/when-you-are-js-developer/dart-vs.-javascript.html">Dart vs. JavaScript</a></li></ol></li><li class="chapter-item expanded "><a href="../welcome/which-resources-you-need.html">‚ú® Which resources you need</a></li><li class="chapter-item expanded "><a href="../welcome/how-to-get-the-most-out-of-this-tutorial.html">üßê How to get the most out of this tutorial</a></li><li class="chapter-item expanded "><a href="../welcome/what-does-this-tutorial-not-contain.html">‚ö†Ô∏è What does this tutorial NOT contain?</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Fundamentals</li><li class="spacer"></li><li class="chapter-item expanded "><a href="../fundamentals/android-studio/index.html">Android Studio</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../fundamentals/android-studio/set-up.html">Set up</a></li><li class="chapter-item expanded "><a href="../fundamentals/android-studio/essentials.html">Essentials</a></li></ol></li><li class="chapter-item expanded "><a href="../fundamentals/xcode/index.html">Xcode</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../fundamentals/xcode/set-up.html">Set up</a></li><li class="chapter-item expanded "><a href="../fundamentals/xcode/essentials.html">Essentials</a></li></ol></li><li class="chapter-item expanded "><a href="../fundamentals/flutter/index.html">Flutter</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../fundamentals/flutter/set-up.html">Set up</a></li><li class="chapter-item expanded "><a href="../fundamentals/flutter/essentials.html">Essentials</a></li></ol></li><li class="chapter-item expanded "><a href="../fundamentals/rust/index.html">Rust</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../fundamentals/rust/set-up.html">Set up</a></li><li class="chapter-item expanded "><a href="../fundamentals/rust/essentials.html">Essentials</a></li><li class="chapter-item expanded "><a href="../fundamentals/rust/project-structure.html">Project Structure</a></li><li class="chapter-item expanded "><a href="../fundamentals/rust/rust-docs.html">Create Rust Docs</a></li><li class="chapter-item expanded "><a href="../fundamentals/rust/dependencies-and-features.html">Dependencies and Features</a></li></ol></li><li class="chapter-item expanded "><a href="../fundamentals/ide-visual-studio-code/index.html">IDE: Visual Studio Code</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../fundamentals/ide-visual-studio-code/set-up.html">Set up</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Overview</li><li class="spacer"></li><li class="chapter-item expanded "><a href="../overview/how-everything-works-together/index.html">üí° How everything works together</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../overview/how-everything-works-together/workflow.html">Workflow</a></li><li class="chapter-item expanded "><a href="../overview/how-everything-works-together/handling-code-changes.html">Handling code changes</a></li></ol></li><li class="chapter-item expanded "><a href="../overview/cross-compiling.html">üè≠ Cross-Compiling</a></li><li class="chapter-item expanded "><a href="../overview/flutter-rust-bridge/index.html">üåÅ Flutter Rust Bridge</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../overview/flutter-rust-bridge/about.html">About</a></li><li class="chapter-item expanded "><a href="../overview/flutter-rust-bridge/features.html">Language translations</a></li><li class="chapter-item expanded "><a href="../overview/flutter-rust-bridge/alternatives.html">Alternatives?</a></li></ol></li><li class="chapter-item expanded "><a href="../overview/iota-libraries/index.html">üìö IOTA libraries</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../overview/iota-libraries/iota-wallet-identity.html">iota.rs, wallet.rs and identity.rs</a></li><li class="chapter-item expanded "><a href="../overview/iota-libraries/iota-sdk.html">IOTA SDK and identity.rs</a></li><li class="chapter-item expanded "><a href="../overview/iota-libraries/library-versions.html">Library Versions</a></li><li class="chapter-item expanded "><a href="../overview/iota-libraries/deeper-insights.html">Deeper Insights</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Building without IOTA</li><li class="spacer"></li><li class="chapter-item expanded "><a href="../building-without-iota/flutter-only.html">Flutter only</a></li><li class="chapter-item expanded "><a href="../building-without-iota/flutter-and-rust/index.html">Flutter and Rust</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../building-without-iota/flutter-and-rust/frb-example-app/index.html">FRB Template App - modified Workflow</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../building-without-iota/flutter-and-rust/frb-example-app/common-part-1.html">1. Initialization and Rust part</a></li><li class="chapter-item expanded "><a href="../building-without-iota/flutter-and-rust/frb-example-app/android-instructions.html">2. Android instructions</a></li><li class="chapter-item expanded "><a href="../building-without-iota/flutter-and-rust/frb-example-app/common-macos-ios.html">3. Common macOS/iOS instructions</a></li><li class="chapter-item expanded "><a href="../building-without-iota/flutter-and-rust/frb-example-app/macos-instructions.html">4. macOS instructions</a></li><li class="chapter-item expanded "><a href="../building-without-iota/flutter-and-rust/frb-example-app/ios-instructions.html">5. iOS instructions</a></li><li class="chapter-item expanded "><a href="../building-without-iota/flutter-and-rust/frb-example-app/common-part-2.html">6. Flutter part</a></li><li class="chapter-item expanded "><a href="../building-without-iota/flutter-and-rust/frb-example-app/build-run.html">7. Build and run</a></li></ol></li><li class="chapter-item expanded "><a href="../building-without-iota/flutter-and-rust/logging-example-app/index.html">Logging Example App</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../building-without-iota/flutter-and-rust/logging-example-app/resources.html">Resources</a></li><li class="spacer"></li></ol></li></ol></li><li class="chapter-item expanded "><li class="part-title">Building a Simple App</li><li class="spacer"></li><li class="chapter-item expanded "><a href="../building-a-simple-app/whats-the-result.html">What's the result?</a></li><li class="chapter-item expanded "><a href="../building-a-simple-app/core-api.html">Core API and iota.rs</a></li><li class="chapter-item expanded "><a href="../building-a-simple-app/init-flutter-app-and-setup-frb.html">Init Flutter App and Setup FRB</a></li><li class="chapter-item expanded "><a href="../building-a-simple-app/building-for-android.html">Building for Android</a></li><li class="chapter-item expanded "><a href="../building-a-simple-app/building-for-macos.html">Building for macOS</a></li><li class="chapter-item expanded "><a href="../building-a-simple-app/building-for-ios.html">Building for iOS</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Building a Comprehensive App</li><li class="spacer"></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/whats-the-result.html">What's the result?</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/locations-on-the-filesystem.html">Locations on the filesystem</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/init-flutter-app-and-setup-frb.html">Init Flutter App and Setup FRB</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/rust-code/index.html">Rust Code for Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/rust-code/example-1.html">Example 1: Get Node Information</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/rust-code/example-2.html">Example 2: Generate Mnemonics</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/rust-code/example-3/index.html">Example 3: Create Wallet Account</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/rust-code/example-3/libsodium.html">Libsodium library for Android</a></li></ol></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/rust-code/example-4.html">Example 4: Generate Address</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/rust-code/example-5.html">Example 5: Request Funds</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/rust-code/example-6.html">Example 6: Check Balance</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/rust-code/example-7.html">Example 7: Create DID</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/rust-code/bin-to-hex.html">Bin to Hex</a></li></ol></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/building-for-android.html">Building for Android</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/building-for-macos.html">Building for macOS</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app/building-for-ios.html">Building for iOS</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Building a Comprehensive App using IOTA SDK</li><li class="spacer"></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app-with-iota-sdk/motivation.html">Motivation</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app-with-iota-sdk/building-for-android.html" class="active">Building for Android</a></li><li class="chapter-item expanded "><a href="../building-a-comprehensive-app-with-iota-sdk/building-for-ios/index.html">Building for iOS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../building-a-comprehensive-app-with-iota-sdk/building-for-ios/libsodium.html">Libsodium library for iOS</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="android"><a class="header" href="#android">Android</a></h1>
<hr />
<p>Building The Playground App for Android using <strong>IOTA SDK and identity.rs</strong>.</p>
<p>The steps to follow are entirely analogous to those outlined in the chapters</p>
<ul>
<li><a href="../building-a-comprehensive-app/init-flutter-app-and-setup-frb.html">Building a Comprehensive App -&gt; Init Flutter App and Setup FRB</a></li>
<li><a href="../building-a-comprehensive-app/building-for-android.html">Building a Comprehensive App -&gt; Building for Android</a></li>
</ul>
<p>This is a chapter for advanced users. If it is moving too quickly for you, I would like to refer you to the previous chapters where all the steps were explained.</p>
<hr />
<h2 id="clone-the-github-repository"><a class="header" href="#clone-the-github-repository">Clone the GitHub Repository</a></h2>
<p><a href="https://github.com/iota-for-flutter/playground_app" target="_blank">üëâ ¬† GitHub Repo - Playground App (Flutter only)</a></p>
<p>In a terminal, execute:</p>
<pre><code>% git clone https://github.com/iota-for-flutter/playground_app.git
% cd playground_app
% code .
</code></pre>
<h3 id="correct-the-libraries-in-pubspecyaml"><a class="header" href="#correct-the-libraries-in-pubspecyaml">Correct the libraries in pubspec.yaml</a></h3>
<p>I forgot the 2 dependencies meta and uuid. So please add in pubspec.yaml:</p>
<pre><code>dependencies:
  ...
  meta: ^1.9.1
  uuid: ^4.0.0
</code></pre>
<p>You might also encounter a message asking you to update the dependencies. You can execute updates by typing <code>flutter pub upgrade</code>. There is one exception regarding the dev_dependency ffi_gen: The version number should be</p>
<pre><code>dev_dependencies:
  ...
  ffigen: ^9.0.1
  ...
</code></pre>
<h3 id="fix-the-problem-with-missing-gradle-files"><a class="header" href="#fix-the-problem-with-missing-gradle-files">Fix the problem with missing gradle files</a></h3>
<ul>
<li>Start the Android Emulator</li>
<li>Run the Flutter app with <code>flutter run</code></li>
<li>Stop the Flutter app</li>
<li>Restart VSCode</li>
</ul>
<h3 id="fix-the-gradleexception-error"><a class="header" href="#fix-the-gradleexception-error">Fix the GradleException error</a></h3>
<p>In <em>android/app/build.gradle</em>, replace GradleException by FileNotFoundException.</p>
<p>The error should disappear.</p>
<hr />
<h2 id="setup-the-flutter-rust-bridge"><a class="header" href="#setup-the-flutter-rust-bridge">Setup the Flutter Rust Bridge</a></h2>
<pre><code>% cargo new --lib rust
% cargo install flutter_rust_bridge_codegen
% flutter pub add --dev ffigen &amp;&amp; flutter pub add ffi
% flutter pub add flutter_rust_bridge
% flutter pub add -d build_runner
% flutter pub add -d freezed
% flutter pub add freezed_annotation
</code></pre>
<hr />
<h2 id="add-the-rust-code"><a class="header" href="#add-the-rust-code">Add the Rust Code</a></h2>
<p>This is a brief list of the specific versions I utilized:</p>
<ul>
<li>flutter_rust_bridge: 1.82.5</li>
<li>iota_sdk: 1.1.3</li>
<li>iota_stronghold: 2.0.0</li>
<li>identity_core: 1.0.0</li>
<li>rocksdb: 0.21.0</li>
</ul>
<h3 id="cargotoml"><a class="header" href="#cargotoml">Cargo.toml</a></h3>
<pre><code class="language-rust ignore">[package]
name = &quot;rust&quot;
version = &quot;0.1.0&quot;
edition = &quot;2021&quot;

[dependencies]
flutter_rust_bridge = &quot;1&quot;

iota-sdk = { version = &quot;1.1.3&quot;, default-features = false, features = [
    &quot;client&quot;,
    &quot;wallet&quot;,
    &quot;tls&quot;,
    &quot;rocksdb&quot;,
    &quot;stronghold&quot;,
] }

identity_iota = { version = &quot;1.0.0&quot;, features = [&quot;memstore&quot;] }

tokio = { version = &quot;1.34.0&quot;, features = [&quot;full&quot;] }
anyhow = { version = &quot;1.0.75&quot; }

serde = { version = &quot;1.0.193&quot;, default-features = false, features = [&quot;derive&quot;] }
serde_json = { version = &quot;1.0.108&quot;, default-features = false }

lazy_static = &quot;1.4.0&quot;
once_cell = &quot;1.19.0&quot;

[lib]
crate-type = [&quot;staticlib&quot;, &quot;cdylib&quot;]</code></pre>
<blockquote>
<p>Make sure to include the necessary features for utilizing Stronghold and RocksDB. Forgetting any feature might render certain code inaccessible. If you're interested, simply download the library code from GitHub and check it out.</p>
</blockquote>
<h3 id="create-apirs"><a class="header" href="#create-apirs">Create api.rs</a></h3>
<ol>
<li>
<p>As usual, create an empty file called <code>api.rs</code>, at the same level as <code>lib.rs</code>.</p>
</li>
<li>
<p>Include it as module in <code>lib.rs</code>:</p>
<pre><code class="language-rust  ignore">mod api;</code></pre>
</li>
</ol>
<h3 id="add-the-content-of-apirs"><a class="header" href="#add-the-content-of-apirs">Add the content of api.rs</a></h3>
<pre><code class="language-rust ignore">use anyhow::Result;
use tokio::runtime::Runtime;

use iota_sdk::{
    client::secret::stronghold::StrongholdSecretManager as WalletStrongholdSecretManager,
    client::secret::SecretManager as WalletSecretManager,
    client::utils::request_funds_from_faucet,
    client::Client,
    types::block::{address::Bech32Address, output::AliasOutput},
};

use std::{env, path::PathBuf, u32};

use identity_iota::{
    iota::{IotaClientExt, IotaDocument, IotaIdentityClientExt, NetworkName},
    storage::{JwkDocumentExt, JwkMemStore, KeyIdMemstore, Storage},
    verification::{jws::JwsAlgorithm, MethodScope},
};

mod wallet_singleton;

#[derive(Debug, Clone)]
pub struct NetworkInfo {
    pub node_url: String,
    pub faucet_url: String,
}

#[allow(dead_code)]
pub fn get_node_info(network_info: NetworkInfo) -&gt; Result&lt;String&gt; {
    let rt = Runtime::new().unwrap();
    rt.block_on(async {
        let node_url = network_info.node_url;

        // Create a client with that node.
        let client = Client::builder()
            .with_node(&amp;node_url)?
            .with_ignore_node_health()
            .finish()
            .await?;

        // Get node info.
        let info = client.get_info().await?.node_info;

        Ok(serde_json::to_string_pretty(&amp;info).unwrap())
        //Ok(info.node_info.base_token.name)
    })
}

#[allow(dead_code)]
pub fn generate_mnemonic() -&gt; String {
    let mnemonic = Client::generate_mnemonic();
    mnemonic.unwrap().to_string()
}

#[derive(Debug, Clone)]
pub struct WalletInfo {
    pub alias: String,
    pub mnemonic: String,
    pub stronghold_password: String,
    pub stronghold_filepath: String,
    pub last_address: String,
}

#[allow(dead_code)]
pub fn create_wallet_account(network_info: NetworkInfo, wallet_info: WalletInfo) -&gt; Result&lt;String&gt; {
    wallet_singleton::create_wallet_account(network_info, wallet_info)
}

#[allow(dead_code)]
pub fn generate_address(wallet_info: WalletInfo) -&gt; Result&lt;String&gt; {
    wallet_singleton::generate_address(wallet_info)
}

#[allow(dead_code)]
pub fn request_funds(network_info: NetworkInfo, wallet_info: WalletInfo) -&gt; Result&lt;String&gt; {
    let rt = Runtime::new().unwrap();
    rt.block_on(async {
        let stronghold_filepath = wallet_info.stronghold_filepath;
        let last_address = wallet_info.last_address;
        env::set_current_dir(&amp;stronghold_filepath).ok();

        let faucet_url = network_info.faucet_url;

        // Convert given address (BECH32 string) to Address struct
        let address = Bech32Address::try_from_str(&amp;last_address)?;

        // Use the function iota_wallet::iota_client::request_funds_from_faucet
        let faucet_response = request_funds_from_faucet(&amp;faucet_url, &amp;address).await?;

        Ok(faucet_response.to_string())
    })
}

#[derive(Debug, Clone)]
pub struct BaseCoinBalance {
    /// Total amount
    pub total: u64,
    /// Balance that can currently be spent
    pub available: u64,
}

#[allow(dead_code)]
pub fn check_balance(wallet_info: WalletInfo) -&gt; Result&lt;BaseCoinBalance&gt; {
    wallet_singleton::check_balance(wallet_info)
}

type MemStorage = Storage&lt;JwkMemStore, KeyIdMemstore&gt;;
#[allow(dead_code)]
pub fn create_decentralized_identifier(
    network_info: NetworkInfo,
    wallet_info: WalletInfo,
) -&gt; Result&lt;String&gt; {
    let rt = Runtime::new().unwrap();
    rt.block_on(async {
        let node_url = network_info.node_url;
        let stronghold_password = wallet_info.stronghold_password;
        let stronghold_filepath = wallet_info.stronghold_filepath;
        let last_address = wallet_info.last_address;

        env::set_current_dir(&amp;stronghold_filepath).ok();

        let mut path_buf_snapshot = PathBuf::new();
        path_buf_snapshot.push(&amp;stronghold_filepath);
        path_buf_snapshot.push(&quot;wallet.stronghold&quot;);
        let path_snapshot = PathBuf::from(path_buf_snapshot);

        // Create a new client to interact with the IOTA ledger.
        let client: Client = Client::builder()
            .with_primary_node(&amp;node_url, None)?
            .finish()
            .await?;

        // Create a new secret manager backed by a Stronghold.
        let secret_manager: WalletSecretManager = WalletSecretManager::Stronghold(
            WalletStrongholdSecretManager::builder()
                .password(stronghold_password)
                .build(path_snapshot)?,
        );

        // Convert given address (BECH32 string) to Address struct
        let address = Bech32Address::try_from_str(&amp;last_address)?;

        // Get the Bech32 human-readable part (HRP) of the network.
        let network_name: NetworkName = client.network_name().await?;

        // Create a new DID document with a placeholder DID.
        // The DID will be derived from the Alias Id of the Alias Output after publishing.
        let mut document: IotaDocument = IotaDocument::new(&amp;network_name);

        // Insert a new Ed25519 verification method in the DID document.
        let storage: MemStorage = MemStorage::new(JwkMemStore::new(), KeyIdMemstore::new());
        document
            .generate_method(
                &amp;storage,
                JwkMemStore::ED25519_KEY_TYPE,
                JwsAlgorithm::EdDSA,
                None,
                MethodScope::VerificationMethod,
            )
            .await?;

        // Insert a new Ed25519 verification method in the DID document.
        let storage: MemStorage = MemStorage::new(JwkMemStore::new(), KeyIdMemstore::new());
        document
            .generate_method(
                &amp;storage,
                JwkMemStore::ED25519_KEY_TYPE,
                JwsAlgorithm::EdDSA,
                None,
                MethodScope::VerificationMethod,
            )
            .await?;

        // Construct an Alias Output containing the DID document, with the wallet address
        // set as both the state controller and governor.
        let alias_output: AliasOutput = client.new_did_output(*address, document, None).await?;

        // Publish the Alias Output and get the published DID document.
        let document: IotaDocument = client
            .publish_did_output(&amp;secret_manager, alias_output)
            .await?;
        Ok(document.to_string())
    })
}

#[allow(dead_code)]
pub fn bin_to_hex(val: String, len: usize) -&gt; String {
    let n: u32 = u32::from_str_radix(&amp;val, 2).unwrap();
    format!(&quot;{:01$x}&quot;, n, len * 2)
}</code></pre>
<h3 id="create-a-new-file-wallet_singletonrs"><a class="header" href="#create-a-new-file-wallet_singletonrs">Create a new file <code>wallet_singleton.rs</code></a></h3>
<p>Create a folder named <code>api</code> next to <code>api.rs</code>. Inside of this folder, create a new file <code>wallet_singleton.rs</code> and copy/paste this content in it:</p>
<pre><code class="language-rust ignore">use crate::api::{BaseCoinBalance, NetworkInfo, WalletInfo};
use anyhow::{Error, Result};
use iota_sdk::{
    client::constants::SHIMMER_COIN_TYPE,
    client::secret::stronghold::StrongholdSecretManager as WalletStrongholdSecretManager,
    client::secret::SecretManager as WalletSecretManager,
    crypto::keys::bip39::Mnemonic,
    wallet::{ClientOptions, Wallet},
};
use std::env;
use std::fs;
use std::path::PathBuf;
use std::sync::{Mutex, Once};
use tokio::runtime::Runtime;

struct WalletSingleton {
    network_info: NetworkInfo,
    wallet_info: WalletInfo,
    wallet: Option&lt;Wallet&gt;,
}

impl WalletSingleton {
    fn new(network_info: NetworkInfo, wallet_info: WalletInfo) -&gt; Result&lt;Self&gt; {
        let mut wallet_singleton = Self {
            network_info,
            wallet_info,
            wallet: None,
        };

        wallet_singleton.create_wallet()?;
        Ok(wallet_singleton)
    }

    fn create_wallet(&amp;mut self) -&gt; Result&lt;String&gt; {
        let rt = Runtime::new().unwrap();
        rt.block_on(async {
            let node_url = &amp;self.network_info.node_url;

            let stronghold_password = self.wallet_info.stronghold_password.clone();
            let stronghold_filepath = self.wallet_info.stronghold_filepath.clone();
            let mnemonic_string: String = self.wallet_info.mnemonic.clone();
            let mnemonic = Mnemonic::from(mnemonic_string);

            // Create the needed directory according to the given path
            let mut path_buf = PathBuf::new();
            path_buf.push(&amp;stronghold_filepath);
            let path = PathBuf::from(path_buf);
            fs::create_dir_all(path).ok();

            // THIS NEXT STEP IS CRUCIAL:
            // Point the &quot;current working directory&quot; to the given path
            env::set_current_dir(&amp;stronghold_filepath).ok();

            // Create the Rust file for the stronghold snapshot file
            let mut path_buf_snapshot = PathBuf::new();
            path_buf_snapshot.push(&amp;stronghold_filepath);
            path_buf_snapshot.push(&quot;wallet.stronghold&quot;);
            let path_snapshot = PathBuf::from(path_buf_snapshot);

            let secret_manager = WalletStrongholdSecretManager::builder()
                .password(stronghold_password)
                .build(path_snapshot)?;

            // Storing the mnemonic is ONLY REQUIRED THE FIRST TIME
            // calling it TWICE THROWS AN ERROR
            secret_manager.store_mnemonic(mnemonic).await?;

            // Create a ClientBuilder (= client_options in wallet.rs)
            // See wallet.rs:
            // -&gt; src/lib.rs
            // -&gt; line &quot;pub use iota_client::ClientBuilder as ClientOptions&quot;
            let client_options = ClientOptions::new().with_node(&amp;node_url)?;

            // Create the account manager with the secret_manager
            // and client_options (= ClientBuilder).
            // The Client itself is created in the AccountManagerBuilder's finish() method.
            // See wallet.rs:
            // -&gt; src/account_manager/builder.rs
            // -&gt; line &quot;let client = client_options.clone().finish()?;&quot;

            self.wallet = Some(
                Wallet::builder()
                    .with_secret_manager(WalletSecretManager::Stronghold(secret_manager))
                    .with_client_options(client_options)
                    .with_coin_type(SHIMMER_COIN_TYPE)
                    .finish()
                    .await?,
            );

            Ok(&quot;Wallet Account was created successfully.&quot;.into())
        })
    }

    fn create_account(&amp;self, wallet_info: WalletInfo) -&gt; Result&lt;String&gt; {
        let wallet_singleton = self;
        let result = Runtime::new().unwrap().block_on(async {
            if let Some(ref wallet) = wallet_singleton.wallet {
                let wallet_alias = wallet_info.alias;
                let _account = wallet
                    .create_account()
                    .with_alias((&amp;wallet_alias).to_string())
                    .finish()
                    .await?;
                Ok(&quot;Account was created successfully.&quot;.into())
            } else {
                Err(Error::msg(&quot;No wallet set.&quot;))
            }
        });
        result
    }

    fn generate_address(&amp;self, wallet_info: WalletInfo) -&gt; Result&lt;String&gt; {
        let wallet_singleton = self;
        let rt = Runtime::new().unwrap();
        rt.block_on(async {
            if let Some(ref wallet) = wallet_singleton.wallet {
                let stronghold_password = wallet_info.stronghold_password;
                let wallet_alias = wallet_info.alias;
                let account = wallet.get_account((&amp;wallet_alias).to_string()).await?;

                wallet.set_stronghold_password(stronghold_password).await?;

                let addresses = account.generate_ed25519_addresses(1, None).await?;
                Ok(addresses[0].address().to_string())
            } else {
                Err(Error::msg(&quot;No wallet set.&quot;))
            }
        })
    }

    fn check_balance(&amp;self, wallet_info: WalletInfo) -&gt; Result&lt;BaseCoinBalance&gt; {
        let wallet_singleton = self;
        let rt = Runtime::new().unwrap();
        rt.block_on(async {
            if let Some(ref wallet) = wallet_singleton.wallet {
                let stronghold_filepath = wallet_info.stronghold_filepath;
                env::set_current_dir(&amp;stronghold_filepath).ok();

                let wallet_alias = wallet_info.alias;
                let account = wallet.get_account((&amp;wallet_alias).to_string()).await?;

                // Sync and get the balance
                let account_balance = account.sync(None).await?;

                let base_coin_balance = BaseCoinBalance {
                    total: account_balance.base_coin().total(),
                    available: account_balance.base_coin().available(),
                };
                //let total = account_balance.base_coin.total;
                //println!(&quot;{:?}&quot;, account_balance);

                //Ok(total.to_string())
                Ok(base_coin_balance)
            } else {
                Err(Error::msg(&quot;No wallet set.&quot;))
            }
        })
    }
}

lazy_static::lazy_static! {
    static ref WALLET_SINGLETON: Mutex&lt;Option&lt;WalletSingleton&gt;&gt; = Mutex::new(None);
    static ref INIT: Once = Once::new();
}

fn create_wallet_singleton_if_needed(network_info: NetworkInfo, wallet_info: WalletInfo) {
    INIT.call_once(|| {
        if let Ok(wallet_singleton) = WalletSingleton::new(network_info, wallet_info) {
            let mut locked_wallet_singleton = WALLET_SINGLETON.lock().unwrap();
            *locked_wallet_singleton = Some(wallet_singleton);
        } else {
            // Handle the error
            // You can log an error, panic, or choose an appropriate action.
            panic!(&quot;Error creating wallet singleton&quot;);
        }
    });
}

pub fn create_wallet_account(network_info: NetworkInfo, wallet_info: WalletInfo) -&gt; Result&lt;String&gt; {
    create_wallet_singleton_if_needed(network_info, wallet_info.clone());
    let locked_wallet_singleton = WALLET_SINGLETON.lock().unwrap();
    let wallet_singleton = locked_wallet_singleton.as_ref().unwrap();
    wallet_singleton.create_account(wallet_info)
}

pub fn generate_address(wallet_info: WalletInfo) -&gt; Result&lt;String&gt; {
    let locked_wallet_singleton = WALLET_SINGLETON.lock().unwrap();
    let wallet_singleton = locked_wallet_singleton.as_ref().unwrap();
    wallet_singleton.generate_address(wallet_info)
}

pub fn check_balance(wallet_info: WalletInfo) -&gt; Result&lt;BaseCoinBalance&gt; {
    let locked_wallet_singleton = WALLET_SINGLETON.lock().unwrap();
    let wallet_singleton = locked_wallet_singleton.as_ref().unwrap();
    wallet_singleton.check_balance(wallet_info)
}</code></pre>
<hr />
<h2 id="generate-the-dart-interface"><a class="header" href="#generate-the-dart-interface">Generate the Dart Interface</a></h2>
<p>Use this command (you need to be in the root of your project):</p>
<pre><code>flutter_rust_bridge_codegen \
--rust-input rust/src/api.rs \
--dart-output ./lib/bridge_generated.dart \
--dart-decl-output ./lib/bridge_definitions.dart \
--wasm
</code></pre>
<hr />
<h2 id="adjust-the-dart-code"><a class="header" href="#adjust-the-dart-code">Adjust the Dart Code</a></h2>
<h3 id="include-the-rust-library"><a class="header" href="#include-the-rust-library">Include the Rust library</a></h3>
<p>Create a file <code>ffi.dart</code> next to <code>main.dart</code> and paste this content. As you can see it returns the <em>api</em> variable.</p>
<pre><code>// This file initializes the dynamic library and connects it with the stub
// generated by flutter_rust_bridge_codegen.

import 'dart:ffi';

import 'bridge_generated.dart';
import 'bridge_definitions.dart';
export 'bridge_definitions.dart';

// Re-export the bridge so it is only necessary to import this file.
export 'bridge_generated.dart';
import 'dart:io' as io;

const _base = 'rust';

// On MacOS, the dynamic library is not bundled with the binary,
// but rather directly **linked** against the binary.
final _dylib = io.Platform.isWindows ? '$_base.dll' : 'lib$_base.so';

final Rust api = RustImpl(io.Platform.isIOS || io.Platform.isMacOS
    ? DynamicLibrary.executable()
    : DynamicLibrary.open(_dylib));
</code></pre>
<h3 id="adjust-example-1-get-node-information"><a class="header" href="#adjust-example-1-get-node-information">Adjust Example 1: Get Node Information</a></h3>
<p>The source code for Example 1 can be found at <code>lib/examples/example_0.dart</code>.</p>
<p>At the top, add:</p>
<pre><code class="language-dart">import 'package:flutter_rust_bridge/flutter_rust_bridge.dart';
import '../ffi.dart';
</code></pre>
<p>Replace the fake code of <code>_callFfiNodeInfo()</code> by:</p>
<pre><code class="language-dart">  Future&lt;void&gt; _callFfiNodeInfo() async {
    String nodeUrl =
        Provider.of&lt;AppProvider&gt;(context, listen: false).currentNetwork.url;
    String faucetUrl = Provider.of&lt;AppProvider&gt;(context, listen: false)
            .currentNetwork
            .faucetApiUrl ??
        '';
    final NetworkInfo networkInfo =
        NetworkInfo(nodeUrl: nodeUrl, faucetUrl: faucetUrl);
    try {
      customOverlay.show(context);
      final receivedText = await api.getNodeInfo(networkInfo: networkInfo);
      if (mounted) {
        Provider.of&lt;AppProvider&gt;(context, listen: false).nodeInfo =
            receivedText;
        setState(() =&gt; exampleSteps[1].setOutput(receivedText));
      }
      customOverlay.hide();
    } on FfiException catch (e) {
      setState(() =&gt; exampleSteps[1].setOutput(e.message));
      customOverlay.hide();
    }
  }
</code></pre>
<h3 id="adjust-example-2-generate-mnemonics"><a class="header" href="#adjust-example-2-generate-mnemonics">Adjust Example 2: Generate Mnemonics</a></h3>
<p>The source code for Example 2 can be found at <code>lib/examples/example_1.dart</code>.</p>
<p>At the top, add:</p>
<pre><code class="language-dart">import '../ffi.dart';
</code></pre>
<p>Replace the fake code of <code>_callFfiGenerateMnemonic()</code> by:</p>
<pre><code class="language-dart">  Future&lt;void&gt; _callFfiGenerateMnemonic() async {
    customOverlay.show(context);
    final receivedText = await api.generateMnemonic();
    if (mounted) {
      setState(() {
        Provider.of&lt;AppProvider&gt;(context, listen: false).mnemonic =
            receivedText;
        exampleSteps[1].setOutput(receivedText);
      });
    }
    customOverlay.hide();
  }
</code></pre>
<h3 id="adjust-example-3-create-wallet-account"><a class="header" href="#adjust-example-3-create-wallet-account">Adjust Example 3: Create Wallet Account</a></h3>
<p>The source code for Example 3 can be found at <code>lib/examples/example_2.dart</code>.</p>
<p>At the top, add:</p>
<pre><code class="language-dart">import 'package:flutter_rust_bridge/flutter_rust_bridge.dart';
import '../ffi.dart';
</code></pre>
<p>Replace the fake code of <code>_callFfiCreateWalletAccount()</code> by:</p>
<pre><code class="language-dart">  Future&lt;void&gt; _callFfiCreateWalletAccount() async {
    String nodeUrl =
        Provider.of&lt;AppProvider&gt;(context, listen: false).currentNetwork.url;
    String faucetUrl = Provider.of&lt;AppProvider&gt;(context, listen: false)
            .currentNetwork
            .faucetApiUrl ??
        '';
    final NetworkInfo networkInfo =
        NetworkInfo(nodeUrl: nodeUrl, faucetUrl: faucetUrl);
    final WalletInfo walletInfo = WalletInfo(
      alias: exampleSteps[1].output ?? 'Account_1',
      mnemonic: Provider.of&lt;AppProvider&gt;(context, listen: false).mnemonic,
      strongholdPassword:
          exampleSteps[2].output ?? 'my_super_secret_stronghold_password',
      strongholdFilepath: _strongholdFilePath,
      lastAddress: &quot;&quot;,
    );
    try {
      customOverlay.show(context);

      final receivedText = await api.createWalletAccount(
          networkInfo: networkInfo, walletInfo: walletInfo);
      if (mounted) {
        setState(() =&gt; exampleSteps[3].setOutput(receivedText));
      }
      customOverlay.hide();
    } on FfiException catch (e) {
      setState(() =&gt; exampleSteps[3].setOutput(e.message));
      customOverlay.hide();
    }
  }
</code></pre>
<h3 id="adjust-example-4-generate-address"><a class="header" href="#adjust-example-4-generate-address">Adjust Example 4: Generate Address</a></h3>
<p>The source code for Example 4 can be found at <code>lib/examples/example_3.dart</code>.</p>
<p>At the top, add:</p>
<pre><code class="language-dart">import 'package:flutter_rust_bridge/flutter_rust_bridge.dart';
import '../ffi.dart';
</code></pre>
<p>Replace the fake code of <code>_callFfiGenerateAddress()</code> by:</p>
<pre><code class="language-dart">  Future&lt;void&gt; _callFfiGenerateAddress() async {
    final WalletInfo walletInfo = WalletInfo(
      alias: exampleSteps[1].output ?? 'Account_1',
      mnemonic: Provider.of&lt;AppProvider&gt;(context, listen: false).mnemonic,
      strongholdPassword:
          exampleSteps[2].output ?? 'my_super_secret_stronghold_password',
      strongholdFilepath: _strongholdFilePath,
      lastAddress: Provider.of&lt;AppProvider&gt;(context, listen: false).lastAddress,
    );
    try {
      customOverlay.show(context);

      final receivedText = await api.generateAddress(walletInfo: walletInfo);
      if (mounted) {
        setState(() {
          Provider.of&lt;AppProvider&gt;(context, listen: false).lastAddress =
              receivedText;
          exampleSteps[3].setOutput(receivedText);
        });
      }
      customOverlay.hide();
    } on FfiException catch (e) {
      customOverlay.hide();
      setState(() =&gt; exampleSteps[3].setOutput(e.message));
    }
  }

</code></pre>
<h3 id="adjust-example-5-request-funds"><a class="header" href="#adjust-example-5-request-funds">Adjust Example 5: Request Funds</a></h3>
<p>The source code for Example 5 can be found at <code>lib/examples/example_4.dart</code>.</p>
<p>At the top, add:</p>
<pre><code class="language-dart">import 'package:flutter_rust_bridge/flutter_rust_bridge.dart';
import '../ffi.dart';
</code></pre>
<p>Replace the fake code of <code>_callFfiRequestFunds()</code> by:</p>
<pre><code class="language-dart">  Future&lt;void&gt; _callFfiRequestFunds() async {
    String nodeUrl =
        Provider.of&lt;AppProvider&gt;(context, listen: false).currentNetwork.url;
    String faucetUrl = Provider.of&lt;AppProvider&gt;(context, listen: false)
            .currentNetwork
            .faucetApiUrl ??
        '';
    final NetworkInfo networkInfo =
        NetworkInfo(nodeUrl: nodeUrl, faucetUrl: faucetUrl);
    final WalletInfo walletInfo = WalletInfo(
      alias: &quot;&quot;,
      mnemonic: &quot;&quot;,
      strongholdPassword: &quot;&quot;,
      strongholdFilepath: _strongholdFilePath,
      lastAddress: Provider.of&lt;AppProvider&gt;(context, listen: false).lastAddress,
    );

    try {
      customOverlay.show(context);

      final receivedText = await api.requestFunds(
          networkInfo: networkInfo, walletInfo: walletInfo);
      if (mounted) {
        setState(() =&gt; exampleSteps[1].setOutput(receivedText));
      }
      customOverlay.hide();
    } on FfiException catch (e) {
      customOverlay.hide();
      setState(() =&gt; exampleSteps[1].setOutput(e.message));
    }
  }
</code></pre>
<h3 id="adjust-example-6-check-balance"><a class="header" href="#adjust-example-6-check-balance">Adjust Example 6: Check Balance</a></h3>
<p>The source code for Example 6 can be found at <code>lib/examples/example_5.dart</code>.</p>
<p>At the top, add:</p>
<pre><code class="language-dart">import 'package:flutter_rust_bridge/flutter_rust_bridge.dart';
import 'package:provider/provider.dart';
import '../coin_utils.dart';
import '../data/app_provider.dart';
import '../ffi.dart';
</code></pre>
<p>Replace the fake code of <code>_callFfiCheckBalance()</code> by:</p>
<pre><code class="language-dart">  Future&lt;void&gt; _callFfiCheckBalance() async {
    String coinCurrency =
        Provider.of&lt;AppProvider&gt;(context, listen: false).currentNetwork.coin;
    final WalletInfo walletInfo = WalletInfo(
      alias: exampleSteps[0].output ?? 'Account_1',
      mnemonic: &quot;&quot;,
      strongholdPassword: &quot;&quot;,
      strongholdFilepath: _strongholdFilePath,
      lastAddress: Provider.of&lt;AppProvider&gt;(context, listen: false).lastAddress,
    );

    try {
      customOverlay.show(context);

      final receivedBaseCoinBalance =
          await api.checkBalance(walletInfo: walletInfo);
      if (mounted) {
        String totalString =
            displayBalance(receivedBaseCoinBalance.total, coinCurrency);
        String availableString =
            displayBalance(receivedBaseCoinBalance.available, coinCurrency);
        String result =
            'Total:         $totalString\nAvailable:  $availableString';
        setState(() {
          exampleSteps[1].setOutput(result);
          Provider.of&lt;AppProvider&gt;(context, listen: false).balanceTotal =
              receivedBaseCoinBalance.total;
          Provider.of&lt;AppProvider&gt;(context, listen: false).balanceAvailable =
              receivedBaseCoinBalance.available;
        });
      }
      customOverlay.hide();
    } on FfiException catch (e) {
      customOverlay.hide();
      setState(() =&gt; exampleSteps[1].setOutput(e.message));
    }
  }
</code></pre>
<h3 id="adjust-example-7-create-did"><a class="header" href="#adjust-example-7-create-did">Adjust Example 7: Create DID</a></h3>
<p>The source code for Example 7 can be found at <code>lib/examples/example_6.dart</code>.</p>
<p>At the top, add:</p>
<pre><code class="language-dart">import 'package:flutter_rust_bridge/flutter_rust_bridge.dart';
import '../ffi.dart';
</code></pre>
<p>Replace the fake code of <code>_callFfiCreateDecentralizedIdentifier()</code> by:</p>
<pre><code class="language-dart">  Future&lt;void&gt; _callFfiCreateDecentralizedIdentifier() async {
    String nodeUrl =
        Provider.of&lt;AppProvider&gt;(context, listen: false).currentNetwork.url;
    final NetworkInfo networkInfo =
        NetworkInfo(nodeUrl: nodeUrl, faucetUrl: '');
    final WalletInfo walletInfo = WalletInfo(
      alias: &quot;&quot;,
      mnemonic: &quot;&quot;,
      strongholdPassword: 'my_super_secret_stronghold_password',
      strongholdFilepath: _strongholdFilePath,
      lastAddress: Provider.of&lt;AppProvider&gt;(context, listen: false).lastAddress,
    );

    try {
      customOverlay.show(context);

      final receivedText = await api.createDecentralizedIdentifier(
          networkInfo: networkInfo, walletInfo: walletInfo);
      if (mounted) {
        setState(() {
          exampleSteps[0].setOutput(receivedText);
        });
      }
      customOverlay.hide();
    } on FfiException catch (e) {
      customOverlay.hide();
      setState(() =&gt; exampleSteps[0].setOutput(e.message));
    }
  }
</code></pre>
<h3 id="adjust-my_drawerdart"><a class="header" href="#adjust-my_drawerdart">Adjust my_drawer.dart</a></h3>
<p>The source code can be found at <code>lib/widgets/my_drawer.dart</code>.</p>
<p>At the top, add:</p>
<pre><code class="language-dart">import '../ffi.dart';
</code></pre>
<p>Replace the fake code in line 59 <code>receivedText = 'fake 0000 0000 0000';</code> by:</p>
<pre><code class="language-dart">  receivedText = await api.binToHex(val: substr, len: 1);
</code></pre>
<p>Update the correct libs and versions, too. You'll find the right place.</p>
<pre><code class="language-dart">...
              Container(
                margin: const EdgeInsets.only(top: 20, bottom: 5),
                padding: const EdgeInsets.symmetric(horizontal: 20),
                alignment: Alignment.topLeft,
                height: 24,
                child: Text(
                  'Included Rust Libraries',
                  style: Theme.of(context).textTheme.titleLarge,
                ),
              ),
              Container(
                padding:
                    const EdgeInsets.symmetric(horizontal: 20, vertical: 2),
                child: const Row(
                  children: [
                    SizedBox(
                      width: 100,
                      child: Text(
                        'iota_sdk:',
                      ),
                    ),
                    Text(&quot;v1.1.3&quot;),
                  ],
                ),
              ),
              Container(
                padding:
                    const EdgeInsets.symmetric(horizontal: 20, vertical: 2),
                child: const Row(
                  children: [
                    SizedBox(
                      width: 100,
                      child: Text(
                        'iota_stronghold:',
                      ),
                    ),
                    Text(&quot;v2.0.0&quot;),
                  ],
                ),
              ),
              Container(
                padding:
                    const EdgeInsets.symmetric(horizontal: 20, vertical: 2),
                child: const Row(
                  children: [
                    SizedBox(
                      width: 100,
                      child: Text(
                        'identity_iota:',
                     ),
                    ),
                    Text(&quot;v1.0.0&quot;),
                  ],
                ),
              ),
...
</code></pre>
<hr />
<h2 id="configure-the-android-setup"><a class="header" href="#configure-the-android-setup">Configure the Android setup</a></h2>
<h3 id="install-the-cargo-ndk-for-android"><a class="header" href="#install-the-cargo-ndk-for-android">Install the cargo-ndk for Android</a></h3>
<pre><code>% cd rust
% cargo install cargo-ndk
% cd ..
</code></pre>
<h3 id="integrate-cargo-build-into-the-gradle-build-process"><a class="header" href="#integrate-cargo-build-into-the-gradle-build-process">Integrate <code>cargo build</code> into the Gradle build process</a></h3>
<p>If you've had NO problem with the 3rd party library <em>libsodium</em>, add at the bottom:</p>
<pre><code>[
        Debug: null,
        Profile: '--release',
        Release: '--release'
].each {
    def taskPostfix = it.key
    def profileMode = it.value
    tasks.whenTaskAdded { task -&gt;
        if (task.name == &quot;javaPreCompile$taskPostfix&quot;) {
            task.dependsOn &quot;cargoBuild$taskPostfix&quot;
        }
    }
    tasks.register(&quot;cargoBuild$taskPostfix&quot;, Exec) {
        workingDir &quot;../../rust&quot;  // &lt;-- ATTENTION: CHECK THE CORRECT FOLDER!!!
        environment ANDROID_NDK_HOME: &quot;$ANDROID_NDK&quot;
        commandLine 'cargo', 'ndk',
                // the 2 ABIs below are used by real Android devices
                // '-t', 'armeabi-v7a',
                '-t', 'arm64-v8a',
                // the below 2 ABIs are usually used for Android simulators,
                // add or remove these ABIs as needed.
                // '-t', 'x86',
                // '-t', 'x86_64',
                '-o', '../android/app/src/main/jniLibs', 'build'
        if (profileMode != null) {
            args profileMode
        }
    }
}
</code></pre>
<h3 id="enable-the-dynamic-library-loading"><a class="header" href="#enable-the-dynamic-library-loading">Enable the dynamic library loading</a></h3>
<p>To enable dynamic library loading, you must place the <code>libc++_shared.so</code> file next to the <code>librust.so</code> (which is generated when you execute <code>flutter run</code>). The output directory <em>android/app/src/main/jniLibs/{abi}/</em> is automatically created after the first execution, but not before.</p>
<p>I want to address this point before I run <code>flutter run</code> for the first time. Therefore, I create the directory <em>android/app/src/main/jniLibs/{abi}/</em> manually and place the library <code>libc++_shared.so</code> in there.</p>
<p>Here are some download links from Android NDK 25 on macOS:</p>
<ul>
<li><a href="../assets/download/arm64-v8a/libc++_shared.so">arm64-v8a/libc++_shared.so</a></li>
<li><a href="../assets/download/armeabi-v7a/libc++_shared.so">armeabi-v7a/libc++_shared.so</a></li>
<li><a href="../assets/download/x86/libc++_shared.so">x86/libc++_shared.so</a></li>
<li><a href="../assets/download/x86_64/libc++_shared.so">x86_64/libc++_shared.so</a></li>
</ul>
<p>For example, place libc++_shared.so for abi <em>arm64-v8a</em> into the folder <em>android/app/src/main/jniLibs/arm64-v8a/</em></p>
<hr />
<h2 id="start-the-app"><a class="header" href="#start-the-app">Start the app</a></h2>
<ul>
<li>Launch the Emulator</li>
<li>Run <code>flutter run</code></li>
</ul>
<h2 id="video"><a class="header" href="#video">Video</a></h2>
<iframe 
    class="video"  
    src="https://www.youtube.com/embed/WGVJEaKGqzw" 
    title="Building the Playground App for Android using IOTA SDK and identity.rs" 
    frameborder="0" 
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
    allowfullscreen>
</iframe>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../building-a-comprehensive-app-with-iota-sdk/motivation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../building-a-comprehensive-app-with-iota-sdk/building-for-ios/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../building-a-comprehensive-app-with-iota-sdk/motivation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../building-a-comprehensive-app-with-iota-sdk/building-for-ios/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
